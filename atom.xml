<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Rainbow</title>
  <icon>https://nwater23.github.io/icon.png</icon>
  <subtitle>你好世界</subtitle>
  <link href="https://nwater23.github.io/atom.xml" rel="self"/>
  
  <link href="https://nwater23.github.io/"/>
  <updated>2024-04-05T12:27:13.000Z</updated>
  <id>https://nwater23.github.io/</id>
  
  <author>
    <name>Nian Water</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ffmpeg usage</title>
    <link href="https://nwater23.github.io/%E7%AC%94%E8%AE%B0/ffmpeg-usage/"/>
    <id>https://nwater23.github.io/%E7%AC%94%E8%AE%B0/ffmpeg-usage/</id>
    <published>2024-04-05T12:27:13.000Z</published>
    <updated>2024-04-05T12:27:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天又是被ffmpeg折腾得死去活来的一天，为了避免以后浪费时间，有必要记录一下。</p><h3 id="硬件加速"><a class="markdownIt-Anchor" href="#硬件加速"></a> 硬件加速</h3><p><code>-hwaccel &lt;method&gt;</code> 可以用 <code>-hwaccels</code> 查看可用 method</p><p><code>-c:v &lt;encoder&gt;</code> encoder 必须为硬件支持的编解码器：<code>h264_qsv</code>, <code>hevc_qsv</code></p><h3 id="质量控制"><a class="markdownIt-Anchor" href="#质量控制"></a> 质量控制</h3><h3 id="视频剪辑"><a class="markdownIt-Anchor" href="#视频剪辑"></a> 视频剪辑</h3><p><code>-ss &lt;hh:mm:ss&gt;</code> <code>-to &lt;hh:mm:ss&gt;</code> 两个开关控制起始时间和结束时间。</p><p><code>-f concat -i &lt;concat_list_file&gt;</code> 拼接视频，concat_list_file 中需要预先定义好需要的视频文件，可以这样生成：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> *.mp4; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;file &#x27;<span class="variable">$f</span>&#x27;&quot;</span> &gt;&gt; mylist.txt; <span class="keyword">done</span></span><br></pre></td></tr></table></figure><h3 id="画面编辑"><a class="markdownIt-Anchor" href="#画面编辑"></a> 画面编辑</h3><h4 id="压制硬字幕嵌入画面中"><a class="markdownIt-Anchor" href="#压制硬字幕嵌入画面中"></a> 压制硬字幕（嵌入画面中）</h4><p><code>-vf &quot;subtitles=example_subtitle.vtt&quot;</code></p><h4 id="马赛克"><a class="markdownIt-Anchor" href="#马赛克"></a> 马赛克</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -i mask.png -filter_complex <span class="string">&quot;[0:v][1:v]alphamerge,avgblur=128[alf];[0:v][alf]overlay[v]&quot;</span> -map <span class="string">&quot;[v]&quot;</span> -map 0:a -c:v h264_qsv -c:a copy -movflags +faststart output.mp4</span><br></pre></td></tr></table></figure><p><code>avgblur=&lt;number&gt;</code> 数字越大越模糊。</p><p><code>-i mask.png</code> 使用 <code>mask.png</code> 作为遮罩，这张图片需要与视频画面大小一致，白色像素对应打码区域，黑色像素对应保持原样。 <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://superuser.com/a/901705">https://superuser.com/a/901705</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;今天又是被ffmpeg折腾得死去活来的一天，为了避免以后浪费时间，有必要记录一下。&lt;/p&gt;
&lt;h3 id=&quot;硬件加速&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#硬件加速&quot;&gt;&lt;/a&gt; 硬件加速&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;-hwaccel</summary>
        
      
    
    
    
    <category term="笔记" scheme="https://nwater23.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="ffmpeg" scheme="https://nwater23.github.io/tags/ffmpeg/"/>
    
  </entry>
  
  <entry>
    <title>fix Powerpill with Pacman re-download cached packages</title>
    <link href="https://nwater23.github.io/%E6%95%99%E7%A8%8B/Linux/fix-Powerpill-with-Pacman-redl-cached-pkgs/"/>
    <id>https://nwater23.github.io/%E6%95%99%E7%A8%8B/Linux/fix-Powerpill-with-Pacman-redl-cached-pkgs/</id>
    <published>2024-02-06T20:37:06.000Z</published>
    <updated>2024-02-06T20:37:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>There for me, a strange thing happened:</p><ol><li>Powerpill download package files(<code>*.pkg.tar.zst</code>) into CacheDir<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></li><li>Pacman download package files again</li></ol><p>How it happen?</p><span id="more"></span><h2 id="possible-1-signature-check-failed"><a class="markdownIt-Anchor" href="#possible-1-signature-check-failed"></a> Possible 1: Signature check failed</h2><p>Pacman does check every pkg file according to default <code>pacman.conf</code>. For safety reason you should not change this options.</p><h2 id="possible-2-aira2c-does-downloading-to-part-file"><a class="markdownIt-Anchor" href="#possible-2-aira2c-does-downloading-to-part-file"></a> Possible 2: Aira2c does downloading to <code>.part</code> file</h2><p>Check the <code>/etc/pacman.conf</code>:</p><figure class="highlight plaintext"><figcaption><span>/etc/pacman.conf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[options]</span><br><span class="line">#XferCommand = /usr/bin/curl -L -C - -f -o %o %u</span><br><span class="line">#XferCommand = /usr/bin/wget --passive-ftp -c -O %o %u</span><br><span class="line">XferCommand = /usr/local/bin/aria2c --allow-overwrite=true --continue=true --file-allocation=none --log-level=error --max-tries=5 --max-connection-per-server=5 -s 1024 --lowest-speed-limit=200k --max-file-not-found=5 --min-split-size=4M --no-conf --remote-time=true --summary-interval=60 --timeout=5 --dir=/ --out %o %u</span><br></pre></td></tr></table></figure><p>Look at the <code>XferCommand</code>’s value, when pacman downloading pkg file e.g. <code>http://mirrors.tuna.tsinghua.edu.cn/archlinux/core/os/x86_64/pacman-6.0.2-8-x86_64.pkg.tar.zst</code>, the command executed is:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/aria2c \</span><br><span class="line">  --allow-overwrite=<span class="literal">true</span> --<span class="built_in">continue</span>=<span class="literal">true</span> --file-allocation=none \</span><br><span class="line">  --log-level=error --max-tries=5 --max-connection-per-server=5 \</span><br><span class="line">  -s 1024 --lowest-speed-limit=200k --max-file-not-found=5 --min-split-size=4M \</span><br><span class="line">  --no-conf --remote-time=<span class="literal">true</span> --summary-interval=60 --<span class="built_in">timeout</span>=5 \</span><br><span class="line">  --<span class="built_in">dir</span>=/ \</span><br><span class="line">  --out /var/cache/pacman/pkg/pacman-6.0.2-8-x86_64.pkg.tar.zst \</span><br><span class="line">  http://mirrors.tuna.tsinghua.edu.cn/archlinux/core/os/x86_64/pacman-6.0.2-8-x86_64.pkg.tar.zst</span><br></pre></td></tr></table></figure><p>You’ll see it writes to file <code>//var/cache/pacman/pkg/pacman-6.0.2-8-x86_64.pkg.tar.zst.part</code>, the prefix <code>//</code> and suffix <code>.part</code> it not we expected.</p><p>This configure file will statisfiy we requirements:<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></p><figure class="highlight plaintext"><figcaption><span>/etc/pacman.conf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[options]</span><br><span class="line">XferCommand = echo Downloading %u ... &amp;&amp; /usr/bin/aria2c --conf-path=/root/.aria2/pacman-aria2.conf %u</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><figcaption><span>/root/.aria2/pacman-aria2.conf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># error handling</span><br><span class="line">timeout=60</span><br><span class="line">connect-timeout=30</span><br><span class="line">max-tries=5</span><br><span class="line">retry-wait=10</span><br><span class="line">max-file-not-found=1</span><br><span class="line"></span><br><span class="line"># downloading</span><br><span class="line">split=3</span><br><span class="line">max-connection-per-server=3</span><br><span class="line">min-split-size=1M</span><br><span class="line">max-concurrent-downloads=1</span><br><span class="line">file-allocation=none</span><br><span class="line">remote-time=true</span><br><span class="line">conditional-get=true</span><br><span class="line">no-netrc=true</span><br><span class="line"></span><br><span class="line"># resuming</span><br><span class="line">continue=true</span><br><span class="line">allow-overwrite=true</span><br><span class="line">always-resume=false</span><br><span class="line"></span><br><span class="line"># proxy</span><br><span class="line">#http-proxy=127.0.0.1:8080</span><br><span class="line">#https-proxy=127.0.0.1:8080</span><br><span class="line">#ftp-proxy=127.0.0.1:8080</span><br><span class="line"></span><br><span class="line"># console</span><br><span class="line">#quiet=true</span><br><span class="line">console-log-level=warn</span><br><span class="line">summary-interval=0</span><br><span class="line">#enable-color=false</span><br><span class="line">#human-readable=false</span><br><span class="line">#show-console-readout=false</span><br><span class="line">#truncate-console-readout=false</span><br><span class="line"></span><br><span class="line"># logging</span><br><span class="line">log-level=warn</span><br><span class="line">log=/var/log/pacman-aria2.log</span><br></pre></td></tr></table></figure><h2 id="possible-3-miss-time-stamp-local-file-is-older-than-server"><a class="markdownIt-Anchor" href="#possible-3-miss-time-stamp-local-file-is-older-than-server"></a> Possible 3: miss time stamp / local file is older than server</h2><p>If server(Mirror server) did not pass the file update time to aria2c/wget/curl, then your client will download again. It behave as if as the local file is older than server.</p><p>If no time stamp provides, it will be default to <code>1 January 1970 00:00:00 UTC</code> (Unix Timestamp <code>0</code>).</p><p>To check if a mirror site provides file update time or not yet at all, run follow command:<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --silent --<span class="built_in">head</span> <span class="string">&quot;<span class="subst">$(pacman -Sp pacman --cachedir /dev/null)</span>&quot;</span> | grep Last-Modified</span><br></pre></td></tr></table></figure><p>Command result should be like <code>Last-Modified: Wed, 20 Sep 2023 23:37:12 GMT</code>.</p><ul><li>If <code>grep</code> exited with return value <code>1</code>, it means no match line found, this only happens when server response does not contain a time stamp.</li></ul><h2 id="end"><a class="markdownIt-Anchor" href="#end"></a> End</h2><p>This is the first time I write blog in English.</p><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>Defined in <code>/etc/pacman.conf</code> <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://bbs.archlinux.org/post.php?tid=192072&amp;qid=1491879">pacman and aria2 - better configuration?</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p></li><li id="fn3" class="footnote-item"><p><a href="https://bbs.archlinux.org/post.php?tid=269644&amp;qid=1992948">https://bbs.archlinux.org/post.php?tid=269644&amp;qid=1992948</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p></li></ol></section>]]></content>
    
    
    <summary type="html">&lt;p&gt;There for me, a strange thing happened:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Powerpill download package files(&lt;code&gt;*.pkg.tar.zst&lt;/code&gt;) into CacheDir&lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn1&quot; id=&quot;fnref1&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;Pacman download package files again&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;How it happen?&lt;/p&gt;</summary>
    
    
    
    <category term="教程" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/"/>
    
    <category term="Linux" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/Linux/"/>
    
    
    <category term="Linux" scheme="https://nwater23.github.io/tags/Linux/"/>
    
    <category term="Arch Linux" scheme="https://nwater23.github.io/tags/Arch-Linux/"/>
    
    <category term="Pacman" scheme="https://nwater23.github.io/tags/Pacman/"/>
    
    <category term="Powerpill" scheme="https://nwater23.github.io/tags/Powerpill/"/>
    
  </entry>
  
  <entry>
    <title>浏览器扩展 TextareaCache</title>
    <link href="https://nwater23.github.io/%E7%AC%94%E8%AE%B0/Firefox/TextareaCache/"/>
    <id>https://nwater23.github.io/%E7%AC%94%E8%AE%B0/Firefox/TextareaCache/</id>
    <published>2024-02-03T14:16:58.000Z</published>
    <updated>2024-02-03T14:16:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>无意中在这篇文章里发现的：<a href="https://blog.lilydjwg.me/2011/12/24/microsoft-word-is-dangerous.31442.html">危险的 Microsoft Word - 依云’s Blog</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;无意中在这篇文章里发现的：&lt;a href=&quot;https://blog.lilydjwg.me/2011/12/24/microsoft-word-is-dangerous.31442.html&quot;&gt;危险的 Microsoft Word - 依云’s</summary>
        
      
    
    
    
    <category term="笔记" scheme="https://nwater23.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="Firefox" scheme="https://nwater23.github.io/categories/%E7%AC%94%E8%AE%B0/Firefox/"/>
    
    
    <category term="工具" scheme="https://nwater23.github.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="安全" scheme="https://nwater23.github.io/tags/%E5%AE%89%E5%85%A8/"/>
    
    <category term="浏览器扩展" scheme="https://nwater23.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%A9%E5%B1%95/"/>
    
    <category term="Firefox" scheme="https://nwater23.github.io/tags/Firefox/"/>
    
    <category term="Chrome" scheme="https://nwater23.github.io/tags/Chrome/"/>
    
  </entry>
  
  <entry>
    <title>VirtualBox 管理虚拟磁盘 压缩磁盘镜像</title>
    <link href="https://nwater23.github.io/%E6%95%99%E7%A8%8B/VirtualBox/VBoxMange/"/>
    <id>https://nwater23.github.io/%E6%95%99%E7%A8%8B/VirtualBox/VBoxMange/</id>
    <published>2024-01-19T16:00:00.000Z</published>
    <updated>2023-01-19T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>下载<a href="https://learn.microsoft.com/zh-cn/sysinternals/downloads/sdelete">SDelete</a>。</p><div class="note info"><p>接下来的命令默认你已经位于解压了 SDelete 的目录内，或者将其目录加入了环境变量，并且使用 cmd。<br />如果你使用 Powershell 或者其它终端，请自行加上绝对路径/相对路径。</p></div><p>在虚拟机内打开 cmd，执行命令：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdelete -c -z C:</span><br></pre></td></tr></table></figure><p>若你需要压缩其它盘符，更改 <code>C:</code> 即可。详细的操作说明请使用 <code>sdelete -?</code> 查看。</p><p>等待程序正常运行完成后，关闭虚拟机。</p><p>在宿主机上，使用 <code>VBoxManage</code> 工具<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>，压缩已被全部设为<code>0x00</code>的空白空间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VBoxManage modifymedium disk windows_11.vdi --compact</span><br></pre></td></tr></table></figure><div class="note warning"><p>对于 Linux 用户，<code>vboxmanage</code> 与 <code>VBoxManage</code> 是两个不同的命令，请注意大小写。<br />若要处理旧的兼容格式，请考虑 <code>vboxmanage</code>。</p></div><span id="more"></span><p>另请参阅：</p><ul><li><a href="https://forums.virtualbox.org/viewtopic.php?t=75308">VirtualBox Forum - Could not get the storage format of the medium</a></li><li><a href="https://superuser.com/questions/388733/virtualbox-how-to-free-up-unused-vdi-disk-place">StackExchange - VirtualBox - how to free up unused VDI disk place?</a></li><li><a href="https://superuser.com/questions/529149/how-to-compact-virtualboxs-vdi-file-size">StackExchange - How to compact VirtualBox’s VDI file size?</a></li><li><a href="https://wiki.archlinux.org/title/VirtualBox">VirtualBox - ArchWiki</a></li><li><a href="https://learn.microsoft.com/zh-cn/sysinternals/downloads/sdelete">Microsoft Learn / Sysinternals / SDelete</a></li></ul><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-modifymedium">VirtualBox Mannual - Chapter 8. VBoxManage Section 8.31. VBoxManage modifymedium</a><br /><strong>（更新）</strong> 链接的锚点地址有变动(<code>#vboxmanage-modifyvdi</code> -&gt; <code>#vboxmanage-modifymedium</code>) <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section>]]></content>
    
    
    <summary type="html">&lt;p&gt;下载&lt;a href=&quot;https://learn.microsoft.com/zh-cn/sysinternals/downloads/sdelete&quot;&gt;SDelete&lt;/a&gt;。&lt;/p&gt;
&lt;div class=&quot;note info&quot;&gt;&lt;p&gt;接下来的命令默认你已经位于解压了 SDelete 的目录内，或者将其目录加入了环境变量，并且使用 cmd。&lt;br /&gt;
如果你使用 Powershell 或者其它终端，请自行加上绝对路径/相对路径。&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;在虚拟机内打开 cmd，执行命令：&lt;/p&gt;
&lt;figure class=&quot;highlight cmd&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sdelete -c -z C:&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;若你需要压缩其它盘符，更改 &lt;code&gt;C:&lt;/code&gt; 即可。详细的操作说明请使用 &lt;code&gt;sdelete -?&lt;/code&gt; 查看。&lt;/p&gt;
&lt;p&gt;等待程序正常运行完成后，关闭虚拟机。&lt;/p&gt;
&lt;p&gt;在宿主机上，使用 &lt;code&gt;VBoxManage&lt;/code&gt; 工具&lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn1&quot; id=&quot;fnref1&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;，压缩已被全部设为&lt;code&gt;0x00&lt;/code&gt;的空白空间：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;VBoxManage modifymedium disk windows_11.vdi --compact&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&quot;note warning&quot;&gt;&lt;p&gt;对于 Linux 用户，&lt;code&gt;vboxmanage&lt;/code&gt; 与 &lt;code&gt;VBoxManage&lt;/code&gt; 是两个不同的命令，请注意大小写。&lt;br /&gt;
若要处理旧的兼容格式，请考虑 &lt;code&gt;vboxmanage&lt;/code&gt;。&lt;/p&gt;
&lt;/div&gt;</summary>
    
    
    
    <category term="教程" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/"/>
    
    <category term="VirtualBox" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/VirtualBox/"/>
    
    
    <category term="虚拟化" scheme="https://nwater23.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
    <category term="VirtualBox" scheme="https://nwater23.github.io/tags/VirtualBox/"/>
    
  </entry>
  
  <entry>
    <title>VSCode Keychain Issues</title>
    <link href="https://nwater23.github.io/%E6%95%99%E7%A8%8B/VS-Code/VSCode-Keychain-Issues/"/>
    <id>https://nwater23.github.io/%E6%95%99%E7%A8%8B/VS-Code/VSCode-Keychain-Issues/</id>
    <published>2023-07-14T05:08:46.000Z</published>
    <updated>2024-02-07T09:27:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="发现问题"><a class="markdownIt-Anchor" href="#发现问题"></a> 发现问题</h2><p>更新完VSCode，突然提示出错。询问<code>请打开疑难解答指南以解决此问题，也可以使用不用 OS keyring 的较弱加密。</code></p><details>  <summary>有关此提示的i18n信息</summary>  <figure class="highlight json"><figcaption><span>https://github.com/microsoft/vscode-loc/blob/616502b1f429c9ac0dc81004d8be2db96869f01e/i18n/vscode-language-pack-zh-hans/translations/main.i18n.json#L12221</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;vs/workbench/services/secrets/electron-sandbox/secretStorageService&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;encryptionNotAvailableJustTroubleshootingGuide&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无法识别用于在当前桌面环境中存储加密相关数据的 OS keyring。&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;isGnome&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你正在 GNOME 环境中运行，但 OS keyring 不可用用于加密。请确保已安装并运行 gnome-keyring 或其他 libsecret 兼容实现。&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;isKwallet&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你正在 KDE 环境中运行，但 OS keyring 不可用于加密。请确保 kwallet 正在运行。&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;troubleshootingButton&quot;</span><span class="punctuation">:</span> <span class="string">&quot;打开疑难解答指南&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;usePlainText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;使用较弱的加密&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;usePlainTextExtraSentence&quot;</span><span class="punctuation">:</span> <span class="string">&quot;请打开疑难解答指南以解决此问题，也可以使用不用 OS keyring 的较弱加密。&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure></details><hr /><h2 id="解决问题"><a class="markdownIt-Anchor" href="#解决问题"></a> 解决问题</h2><p>根据官方文档<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>的教程，试试看日志有什么报错：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code --verbose --vmodule=<span class="string">&quot;*/components/os_crypt/*=1&quot;</span> | less</span><br></pre></td></tr></table></figure><p>第二行看到了问题所在：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[23476:0714/131505.501724:VERBOSE1:key_storage_util_linux.cc(54)] Password storage detected desktop environment: (unknown)</span><br></pre></td></tr></table></figure><p>那问题很好解决了，直接照着官方文档改一下<code>argv.json</code>就行了。</p><figure class="highlight json"><figcaption><span>~/.vscode/argv.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;password-store&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gnome-libsecret&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><div class="note info"><p>更新（2024-02-07）：对于我而言，此前设置 <code>--password-store=gnome</code> 是有效的，但是 VSCode 更新后，我修改了新设置 <code>--password-store=gnome-libsecret</code> 才修复重新出现的问题。</p></div><span id="more"></span><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>(2023) <a href="https://code.visualstudio.com/docs/editor/settings-sync#_troubleshooting-keychain-issues">Settings SYnc in Visual Studio Code§Troubleshooting keychain issues</a></p><h2 id="troubleshooting-keychain-issues"><a class="markdownIt-Anchor" href="#troubleshooting-keychain-issues"></a> Troubleshooting keychain issues</h2><blockquote><p>NOTE: This section applies to VS Code version <strong>1.80 and higher</strong>. In 1.80, we moved away from <a href="https://github.com/atom/node-keytar">keytar</a>, due to its archival, in favor of Electron’s <a href="https://www.electronjs.org/docs/latest/api/safe-storage">safeStorage API</a>.</p></blockquote><blockquote><p>NOTE: keychain, keyring, wallet, credential store are synonymous in this document.</p></blockquote><p>Settings Sync persists authentication information on desktop using the OS keychain for encryption. Using the keychain can fail in some cases if the keychain is misconfigured or the environment isn’t recognized.</p><p>To help diagnose the problem, you can restart VS Code with the following flags to generate a verbose log:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code --verbose --vmodule=&quot;*/components/os_crypt/*=1&quot;</span><br></pre></td></tr></table></figure><h3 id="windows-macos"><a class="markdownIt-Anchor" href="#windows-macos"></a> Windows &amp; macOS</h3><p>At this time, there are no known configuration issues on Windows or macOS but, if you suspect something is wrong, you can open an <a href="https://github.com/microsoft/vscode/issues/new/choose">issue on VS Code</a> with the verbose logs from above. This is important for us to support additional desktop configurations.</p><h3 id="linux"><a class="markdownIt-Anchor" href="#linux"></a> Linux</h3><p>Towards the top of the logs from the previous command, you will see something to the effect of:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[9699:0626/093542.027629:VERBOSE1:key_storage_util_linux.cc(54)] Password storage detected desktop environment: GNOME</span><br><span class="line">[9699:0626/093542.027660:VERBOSE1:key_storage_linux.cc(122)] Selected backend for OSCrypt: GNOME_ANY</span><br></pre></td></tr></table></figure><p>We rely on Chromium’s oscrypt module to discover and store encryption key information in the keyring. Chromium supports <a href="https://source.chromium.org/chromium/chromium/src/+/main:base/nix/xdg_util.cc;l=146-169">a number of different desktop environments</a>. Outlined below are some popular desktop environments and troubleshooting steps that may help if the keyring is misconfigured.</p><h4 id="gnome-or-unity-or-similar"><a class="markdownIt-Anchor" href="#gnome-or-unity-or-similar"></a> GNOME or UNITY (or similar)</h4><p>If the error you’re seeing is “Cannot create an item in a locked collection”, chances are your keyring’s <code>Login</code> keyring is locked. You should launch your OS’s keyring (<a href="https://wiki.gnome.org/Apps/Seahorse">Seahorse</a> is the commonly used GUI for seeing keyrings) and ensure the default keyring (usually referred to as <code>Login</code> keyring) is unlocked. This keyring needs to be unlocked when you log into your system.</p><h4 id="kde"><a class="markdownIt-Anchor" href="#kde"></a> KDE</h4><blockquote><p>KDE 6 is not yet fully supported by Visual Studio Code. As a workaround: The latest kwallet6 is also accessible as kwallet5, so you can force it to use kwallet5 by setting the password store to <code>kwallet5</code> as explained below in <a href="#other-linux-desktop-environments">Configure the keyring to use with VS Code</a>.</p></blockquote><p>It’s possible that your wallet (aka keyring) is closed. If you open <a href="https://apps.kde.org/kwalletmanager5">KWalletManager</a>, you can see if the default <code>kdewallet</code> is closed and if it is, make sure you open it.</p><h4 id="other-linux-desktop-environments"><a class="markdownIt-Anchor" href="#other-linux-desktop-environments"></a> Other Linux desktop environments</h4><p>First off, if your desktop environment wasn’t detected, you can <a href="https://github.com/microsoft/vscode/issues/new/choose">open an issue on VS Code</a> with the verbose logs from above. This is important for us to support additional desktop configurations.</p><h4 id="recommended-configure-the-keyring-to-use-with-vs-code"><a class="markdownIt-Anchor" href="#recommended-configure-the-keyring-to-use-with-vs-code"></a> (recommended) Configure the keyring to use with VS Code</h4><p>You can manually tell VS Code which keyring to use by passing the <code>password-store</code> flag. Our recommended configuration is to first install <a href="https://wiki.gnome.org/Projects/GnomeKeyring">gnome-keyring</a> if you don’t have it already and then launch VS Code with <code>code --password-store=&quot;gnome&quot;</code>.</p><p>If this solution works for you, you can persist the value of <code>password-store</code> by opening the Command Palette (<code>kb(workbench.action.showCommands)</code>) and running the <strong>Preferences: Configure Runtime Arguments</strong> command. This will open the <code>argv.json</code> file where you can add the setting <code>&quot;password-store&quot;:&quot;gnome&quot;</code>.</p><blockquote><p>NOTE: If you would rather not use <code>gnome-keyring</code>, you can try using a package that implements the <a href="https://www.gnu.org/software/emacs/manual/html_node/auth/Secret-Service-API.html">Secret Service API</a>. If you do this, the <code>password-store</code> flag can still be set to <code>gnome</code> and Electron will detect other implementations of the Secret Service API. Additionally, you could try installing <code>kwallet5</code> on your system. If you do, you will want to set the <code>password-store</code> flag to <code>kwallet5</code> to detect the installed <code>kwallet5</code>. All possible values for <code>password-store</code> can be <a href="https://source.chromium.org/chromium/chromium/src/+/refs/tags/108.0.5359.215:components/os_crypt/key_storage_util_linux.cc;l=35-46">found in Chromium’s source</a>.</p></blockquote><p>Don’t hesitate to <a href="https://github.com/microsoft/vscode/issues/new/choose">open an issue on VS Code</a> with the verbose logs if you run into any issues.</p><h4 id="not-recommended-configure-basic-text-encryption"><a class="markdownIt-Anchor" href="#not-recommended-configure-basic-text-encryption"></a> (not recommended) Configure basic text encryption</h4><p>We rely on Chromium’s oscrypt module to discover and store encryption key information in the keyring. Chromium offers an opt-in fallback encryption strategy that uses an in-memory key based on a string that is hardcoded in the Chromium source. Because of this, this fallback strategy is, at best, obfuscation, and should only be used if you are accepting of the risk that any process on the system could, in theory, decrypt your stored secrets.</p><p>If you accept this risk, you can set <code>password-store</code> to <code>basic</code> by opening the Command Palette (<code>kb(workbench.action.showCommands)</code>) and running the <strong>Preferences: Configure Runtime Arguments</strong> command. This will open the <code>argv.json</code> file where you can add the setting <code>&quot;password-store&quot;:&quot;basic&quot;</code>. <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;发现问题&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#发现问题&quot;&gt;&lt;/a&gt; 发现问题&lt;/h2&gt;
&lt;p&gt;更新完VSCode，突然提示出错。询问&lt;code&gt;请打开疑难解答指南以解决此问题，也可以使用不用 OS keyring 的较弱加密。&lt;/code&gt;&lt;/p&gt;
&lt;details&gt;
  &lt;summary&gt;有关此提示的i18n信息&lt;/summary&gt;
  &lt;figure class=&quot;highlight json&quot;&gt;&lt;figcaption&gt;&lt;span&gt;https://github.com/microsoft/vscode-loc/blob/616502b1f429c9ac0dc81004d8be2db96869f01e/i18n/vscode-language-pack-zh-hans/translations/main.i18n.json#L12221&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;&amp;quot;vs/workbench/services/secrets/electron-sandbox/secretStorageService&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;punctuation&quot;&gt;&amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&amp;quot;encryptionNotAvailableJustTroubleshootingGuide&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;无法识别用于在当前桌面环境中存储加密相关数据的 OS keyring。&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&amp;quot;isGnome&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;你正在 GNOME 环境中运行，但 OS keyring 不可用用于加密。请确保已安装并运行 gnome-keyring 或其他 libsecret 兼容实现。&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&amp;quot;isKwallet&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;你正在 KDE 环境中运行，但 OS keyring 不可用于加密。请确保 kwallet 正在运行。&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&amp;quot;troubleshootingButton&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;打开疑难解答指南&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&amp;quot;usePlainText&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;使用较弱的加密&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&amp;quot;usePlainTextExtraSentence&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;请打开疑难解答指南以解决此问题，也可以使用不用 OS keyring 的较弱加密。&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;punctuation&quot;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;解决问题&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#解决问题&quot;&gt;&lt;/a&gt; 解决问题&lt;/h2&gt;
&lt;p&gt;根据官方文档&lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn1&quot; id=&quot;fnref1&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;的教程，试试看日志有什么报错：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;code --verbose --vmodule=&lt;span class=&quot;string&quot;&gt;&amp;quot;*/components/os_crypt/*=1&amp;quot;&lt;/span&gt; | less&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;第二行看到了问题所在：&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[23476:0714/131505.501724:VERBOSE1:key_storage_util_linux.cc(54)] Password storage detected desktop environment: (unknown)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;那问题很好解决了，直接照着官方文档改一下&lt;code&gt;argv.json&lt;/code&gt;就行了。&lt;/p&gt;
&lt;figure class=&quot;highlight json&quot;&gt;&lt;figcaption&gt;&lt;span&gt;~/.vscode/argv.json&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;punctuation&quot;&gt;&amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;attr&quot;&gt;&amp;quot;password-store&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;gnome-libsecret&amp;quot;&lt;/span&gt;&lt;span class=&quot;punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;punctuation&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&quot;note info&quot;&gt;&lt;p&gt;更新（2024-02-07）：对于我而言，此前设置 &lt;code&gt;--password-store=gnome&lt;/code&gt; 是有效的，但是 VSCode 更新后，我修改了新设置 &lt;code&gt;--password-store=gnome-libsecret&lt;/code&gt; 才修复重新出现的问题。&lt;/p&gt;
&lt;/div&gt;</summary>
    
    
    
    <category term="教程" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/"/>
    
    <category term="VS Code" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/VS-Code/"/>
    
    
    <category term="Linux" scheme="https://nwater23.github.io/tags/Linux/"/>
    
    <category term="IDE" scheme="https://nwater23.github.io/tags/IDE/"/>
    
    <category term="VS Code" scheme="https://nwater23.github.io/tags/VS-Code/"/>
    
  </entry>
  
  <entry>
    <title>在TTY或SSH上使用GPG，即没有GUI界面时</title>
    <link href="https://nwater23.github.io/%E6%95%99%E7%A8%8B/Linux/GPG-on-TTY/"/>
    <id>https://nwater23.github.io/%E6%95%99%E7%A8%8B/Linux/GPG-on-TTY/</id>
    <published>2023-07-14T03:56:13.000Z</published>
    <updated>2023-07-14T03:56:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>当通过ssh远程连接到服务器，或者在纯字符界面的tty上操作时，总之就是在无GUI情况下操作时。<br />使用gpg签名（或者通过<code>git commit -S</code>等调用gpg），会报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg: signing failed: Inappropriate ioctl for device</span><br><span class="line">gpg: [stdin]: clear-sign failed: Inappropriate ioctl for device</span><br></pre></td></tr></table></figure><p>原因是无法调用默认的<code>/usr/bin/pinentry-gtk-2</code>，如果你没安装GTK的话也会出现这个报错。</p><p>根据Arch Wiki介绍<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>，修改<code>.bashrc</code>即可（zsh同理）：</p><figure class="highlight bash"><figcaption><span>.bashrc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GPG_TTY=$(<span class="built_in">tty</span>)</span><br></pre></td></tr></table></figure><span id="more"></span><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>(2023) <a href="https://wiki.archlinux.org/title/GnuPG#Invalid_IPC_response_and_Inappropriate_ioctl_for_device">ArchWiki: GnuPG§9.12 Invalid IPC response and Inappropriate ioctl for device</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">=== Invalid IPC response and Inappropriate ioctl for device ===</span><br><span class="line"></span><br><span class="line">The default pinentry program is &#123;&#123;ic|/usr/bin/pinentry-gtk-2&#125;&#125;. If &#123;&#123;Pkg|gtk2&#125;&#125; is unavailable, pinentry falls back to &#123;&#123;ic|/usr/bin/pinentry-curses&#125;&#125; and causes signing to fail:</span><br><span class="line"></span><br><span class="line">    gpg: signing failed: Inappropriate ioctl for device</span><br><span class="line">    gpg: [stdin]: clear-sign failed: Inappropriate ioctl for device</span><br><span class="line"></span><br><span class="line">You need to set the &#123;&#123;ic|GPG_TTY&#125;&#125; environment variable for the pinentry programs &#123;&#123;ic|/usr/bin/pinentry-tty&#125;&#125; and &#123;&#123;ic|/usr/bin/pinentry-curses&#125;&#125;.</span><br><span class="line"></span><br><span class="line">    $ export GPG_TTY=$(tty)</span><br></pre></td></tr></table></figure> <a href="#fnref1" class="footnote-backref">↩︎</a></li></ol></section>]]></content>
    
    
    <summary type="html">&lt;p&gt;当通过ssh远程连接到服务器，或者在纯字符界面的tty上操作时，总之就是在无GUI情况下操作时。&lt;br /&gt;
使用gpg签名（或者通过&lt;code&gt;git commit -S&lt;/code&gt;等调用gpg），会报错：&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;gpg: signing failed: Inappropriate ioctl for device&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gpg: [stdin]: clear-sign failed: Inappropriate ioctl for device&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;原因是无法调用默认的&lt;code&gt;/usr/bin/pinentry-gtk-2&lt;/code&gt;，如果你没安装GTK的话也会出现这个报错。&lt;/p&gt;
&lt;p&gt;根据Arch Wiki介绍&lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn1&quot; id=&quot;fnref1&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;，修改&lt;code&gt;.bashrc&lt;/code&gt;即可（zsh同理）：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;figcaption&gt;&lt;span&gt;.bashrc&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; GPG_TTY=$(&lt;span class=&quot;built_in&quot;&gt;tty&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="教程" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/"/>
    
    <category term="Linux" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/Linux/"/>
    
    
    <category term="Linux" scheme="https://nwater23.github.io/tags/Linux/"/>
    
    <category term="TTY" scheme="https://nwater23.github.io/tags/TTY/"/>
    
    <category term="SSH" scheme="https://nwater23.github.io/tags/SSH/"/>
    
    <category term="归档和压缩" scheme="https://nwater23.github.io/tags/%E5%BD%92%E6%A1%A3%E5%92%8C%E5%8E%8B%E7%BC%A9/"/>
    
    <category term="GnuPG" scheme="https://nwater23.github.io/tags/GnuPG/"/>
    
  </entry>
  
  <entry>
    <title>QEMU 命令合集</title>
    <link href="https://nwater23.github.io/%E7%AC%94%E8%AE%B0/QEMU/QEMU-Command-Collection/"/>
    <id>https://nwater23.github.io/%E7%AC%94%E8%AE%B0/QEMU/QEMU-Command-Collection/</id>
    <published>2023-07-06T07:08:09.000Z</published>
    <updated>2023-07-06T07:08:09.000Z</updated>
    
    <content type="html"><![CDATA[<p>俗话说，前人栽树，后人乘凉。希望能解决你的问题。</p><script src="https://gist.github.com/NWater23/e86dc92c4cd206f57bc754572e3f8adf.js"></script><span id="more"></span><p>另请参阅：</p><ul><li><a href="https://wiki.archlinux.org/title/QEMU">QEMU - ArchWiki</a></li><li><a href="https://assil.me/2020/07/08/pulseaudio-arch-libvirt.html">Fixing pulseaudio issues with QEMU/libvirt on Arch</a></li><li><a href="https://stackoverflow.com/questions/64560389/setting-up-pulseaudio-in-qemu">Setting up PulseAudio in QEMU</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;俗话说，前人栽树，后人乘凉。希望能解决你的问题。&lt;/p&gt;
&lt;script src=&quot;https://gist.github.com/NWater23/e86dc92c4cd206f57bc754572e3f8adf.js&quot;&gt;&lt;/script&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://nwater23.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="QEMU" scheme="https://nwater23.github.io/categories/%E7%AC%94%E8%AE%B0/QEMU/"/>
    
    
    <category term="Linux" scheme="https://nwater23.github.io/tags/Linux/"/>
    
    <category term="虚拟化" scheme="https://nwater23.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
    <category term="QEMU" scheme="https://nwater23.github.io/tags/QEMU/"/>
    
  </entry>
  
  <entry>
    <title>zip 解压乱码：代码页 cp936</title>
    <link href="https://nwater23.github.io/%E6%95%99%E7%A8%8B/Linux/zip-cp936/"/>
    <id>https://nwater23.github.io/%E6%95%99%E7%A8%8B/Linux/zip-cp936/</id>
    <published>2023-06-09T10:45:20.000Z</published>
    <updated>2023-06-09T10:45:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>Windows 使用的简体中文编码与 UTF-8 不兼容会导致乱码。<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p><p>使用 <code>-O cp936</code> 选项<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> <sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> <sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> <sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> <sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ unzip -O cp936 &lt;zip file&gt;</span><br></pre></td></tr></table></figure><p>也可以给 <code>-O</code> 选项使用参数：</p><ul><li><code>GBK</code></li><li><code>GB2312</code></li><li><code>GB18030</code></li></ul><span id="more"></span><h2 id="备选项"><a class="markdownIt-Anchor" href="#备选项"></a> 备选项 <sup class="footnote-ref"><a href="#fn6" id="fnref6:1">[6:1]</a></sup></h2><p>安装 7zip 和 convmv 工具：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install p7zip-full convmv</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LANG=C</span><br><span class="line">7z x -o&#123;Directory&#125; &lt;zip file&gt;</span><br><span class="line">convmv -f gbk -t utf8 --notest -r &lt;output <span class="built_in">dir</span>&gt;</span><br><span class="line"><span class="comment"># 或者先 cd 到输出文件夹</span></span><br><span class="line">convmv -f gbk -t utf8 --notest  ./*</span><br></pre></td></tr></table></figure><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>(2003) （英文）<a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=197427">#197427 - unzip: chinese filenames unwrapped on unix wrongly</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>(2014) <a href="https://www.zhihu.com/question/20523036/answer/31746415">Linux 下 zip 文件解压乱码如何解决？</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p></li><li id="fn3" class="footnote-item"><p>(2020) <a href="https://zhuanlan.zhihu.com/p/143846450">Ubuntu压缩及解压文件简介</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p></li><li id="fn4" class="footnote-item"><p>(2019) <a href="https://blog.csdn.net/qq_36441393/article/details/102639066">【技巧】linux环境下，用unzip解压zip文件时，若解压文件中存在中文，会出现中文乱码问题</a> <a href="#fnref4" class="footnote-backref">↩︎</a></p></li><li id="fn5" class="footnote-item"><p>(2021) <a href="https://www.cnblogs.com/tesila/p/14982479.html">linux下解压zip乱码问题的解决（unzip）</a> <a href="#fnref5" class="footnote-backref">↩︎</a></p></li><li id="fn6" class="footnote-item"><p>(2016) <a href="https://www.findhao.net/easycoding/1605">Linux文件乱码</a> <a href="#fnref6" class="footnote-backref">↩︎</a> <a href="#fnref6:1" class="footnote-backref">↩︎</a></p></li></ol></section>]]></content>
    
    
    <summary type="html">&lt;p&gt;Windows 使用的简体中文编码与 UTF-8 不兼容会导致乱码。&lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn1&quot; id=&quot;fnref1&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;-O cp936&lt;/code&gt; 选项&lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn2&quot; id=&quot;fnref2&quot;&gt;[2]&lt;/a&gt;&lt;/sup&gt; &lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn3&quot; id=&quot;fnref3&quot;&gt;[3]&lt;/a&gt;&lt;/sup&gt; &lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn4&quot; id=&quot;fnref4&quot;&gt;[4]&lt;/a&gt;&lt;/sup&gt; &lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn5&quot; id=&quot;fnref5&quot;&gt;[5]&lt;/a&gt;&lt;/sup&gt; &lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn6&quot; id=&quot;fnref6&quot;&gt;[6]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ unzip -O cp936 &amp;lt;zip file&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;也可以给 &lt;code&gt;-O&lt;/code&gt; 选项使用参数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;GBK&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GB2312&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GB18030&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="教程" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/"/>
    
    <category term="Linux" scheme="https://nwater23.github.io/categories/%E6%95%99%E7%A8%8B/Linux/"/>
    
    
    <category term="Linux" scheme="https://nwater23.github.io/tags/Linux/"/>
    
    <category term="zip" scheme="https://nwater23.github.io/tags/zip/"/>
    
    <category term="Windows" scheme="https://nwater23.github.io/tags/Windows/"/>
    
    <category term="cp936" scheme="https://nwater23.github.io/tags/cp936/"/>
    
    <category term="GB2312" scheme="https://nwater23.github.io/tags/GB2312/"/>
    
    <category term="GBK" scheme="https://nwater23.github.io/tags/GBK/"/>
    
    <category term="GB18030" scheme="https://nwater23.github.io/tags/GB18030/"/>
    
    <category term="乱码" scheme="https://nwater23.github.io/tags/%E4%B9%B1%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://nwater23.github.io/uncategorized/hello-world/"/>
    <id>https://nwater23.github.io/uncategorized/hello-world/</id>
    <published>2023-06-08T16:00:00.000Z</published>
    <updated>2023-06-08T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt;</summary>
        
      
    
    
    
    
  </entry>
  
</feed>
